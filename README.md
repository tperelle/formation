# cluster_docker

Provisionne un cluster de 4 VM Ubuntu en local :
- un master
- 3 noeuds

L'objectif est d'avoir l'environnement de travail de départ pour dérouler les formations officielles Docker.
On utilise Vagrant comme provider et Ansible comme provisioner.

Pour démarrer l'environnement :
`vagrant up`

Pour vérifier que toutes les VM sont démarrées :
`vagrant global-status`

On peut également utiliser Ansible à partir du host local en utilisant le fichier d'inventaire auto-généré dans :
`cat .vagrant/provisioners/ansible/inventory/vagrant_ansible_inventory`

```
# Generated by Vagrant

master ansible_ssh_host=127.0.0.1 ansible_ssh_port=2202 ansible_ssh_user='vagrant' ansible_ssh_private_key_file='/Users/thomas/.vagrant.d/insecure_private_key'
node1 ansible_ssh_host=127.0.0.1 ansible_ssh_port=2222 ansible_ssh_user='vagrant' ansible_ssh_private_key_file='/Users/thomas/.vagrant.d/insecure_private_key'
node2 ansible_ssh_host=127.0.0.1 ansible_ssh_port=2200 ansible_ssh_user='vagrant' ansible_ssh_private_key_file='/Users/thomas/.vagrant.d/insecure_private_key'
node3 ansible_ssh_host=127.0.0.1 ansible_ssh_port=2201 ansible_ssh_user='vagrant' ansible_ssh_private_key_file='/Users/thomas/.vagrant.d/insecure_private_key'
```
Ping sur l'ensemble de l'inventaire :

```
% ansible all -m ping -i .vagrant/provisioners/ansible/inventory/vagrant_ansible_inventory -u vagrant
master | SUCCESS => {
	    "changed": false,
	        "ping": "pong"
}
node1 | SUCCESS => {
	    "changed": false,
	        "ping": "pong"
}
node3 | SUCCESS => {
	    "changed": false,
	        "ping": "pong"
}
node2 | SUCCESS => {
	    "changed": false,
	        "ping": "pong"
}
```

